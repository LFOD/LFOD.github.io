{
  "hash": "7d815e7e30f0da03ed1f6e9e0f745a1f",
  "result": {
    "markdown": "---\ntitle: 'Bayes Theorem and the Probability of Having COVID-19'\nauthor: \"Lucy D'Agostino McGowan\"\ndate: '2020-04-09'\nslug: bayes-theorem-and-covid-19-infection\ncategories: [statistics, uncertainty, coronavirus, casual inference, bayes theorem]\ntags: [statistics, uncertainty, coronavirus, casual inference, bayes]\ndescription: \"I've seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristic's the probability of infection. Let's talk about why that's likely not true.\"\n---\n\n\nI've seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristic's the **probability of infection**. Let's talk about why that's likely not true.\n\nğŸ‘‰ Usually when thinking about estimating the prevalence of a disease, we use the **sensitivity** and **specificity** of the test to help us     \nğŸ‘‰ The calculations assume that everyone is equally likely to get tested, and with SARS-CoV-2 that is likely not the case\n\nLet's do some ğŸ’­ thought experiments. For these, my goal is to estimate the probability of being infected with ğŸ¦  SARS-CoV-2 given you have ğŸ§© Disease X\n\nFor example,ğŸ§© Disease X could be:    \n\nâ™¥ï¸ heart disease       \nğŸ˜¡ hypertension        \nâ• it could also be any subgroup (for example age, etc)\n\nIn these ğŸ’­ thought experiments, we don't actually have perfect information about who is infected with ğŸ¦  SARS-CoV-2, we just know among those who are ğŸ§ª **tested** who has been infected with ğŸ¦  SARS-CoV-2. This is really the crux of the matter.\n\nFor these ğŸ’­ thought experiments, assume that the current tests are *perfect* (that is there are 0 false positives and 0 false negatives)\n\nâ˜ï¸ Note that this is likely not the case, with the current testing framework false positives (+) are unlikely but false negatives (-) may be occurring.\n\nWe want the probability of being infected with SARS-CoV-2 given you have Disease X: P(ğŸ¦ |ğŸ§©)\n\nTo get this, we need P(ğŸ§©|ğŸ¦ ) because based on Bayes' Theorem we know:\n\nP(ğŸ¦ |ğŸ§©) = P(ğŸ§©|ğŸ¦ )P(ğŸ¦ ) / P(ğŸ§©)\n\nBUT, instead of P(ğŸ§©|ğŸ¦ ), we actually have P(ğŸ§©|ğŸ¦ , ğŸ§ª) - the probability of having  disease X given you have SARS-CoV-2 AND you were tested. So the crux of these thought experiments will be trying to get an accurate estimate of  P(ğŸ§©|ğŸ¦ ) so that we can get back to P(ğŸ¦ |ğŸ§©).\n\n## Thought experiment 1ï¸âƒ£: Best case scenario\n\n<label for=\"tufte-mn-\" class=\"margin-toggle\">&#8853;</label><input type=\"checkbox\" id=\"tufte-mn-\" class=\"margin-toggle\"><span class=\"marginnote\">Note: all of these numbers are made up!</span>\nğŸ§© 20% of the population has disease X    \nğŸ¦   50% are infected with SARS-CoV-2\nâŒ There is no relationship between disease X and SARS-CoV-2      \nğŸ§ª People with disease X are just as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLdlokU4AQauYQ?format=jpg&name=medium)\n\nWhy is thought experiment 1ï¸âƒ£ a best case scenario?\n\nIt looks like:\n\nğŸ§ª 50% have SARS-CoV-2 infection among those tested    \nğŸ§ª Of those who tested positive, the prevalence of disease X is 20%    \nP(ğŸ¦ |ğŸ§©) = 50%\n\nâœ… Reality (no relationship between disease X and SARS-CoV-2) matches what we see\n\n## Thought experiment 2ï¸âƒ£: Oversampling scenario\n\nğŸ§© 20% of the population has disease X\nMicrobe 50% have SARS-CoV-2 infection       \nâŒ There is no relationship between disease X and SARS-CoV-2      \nğŸ§ª People with disease X are **2x** more likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLSv4XUUAAmrVf?format=jpg&name=medium)\n\nWhy is thought experiment 2ï¸âƒ£ bad?\n\nIt looks like:\n\nğŸ§ª 50% have SARS-CoV-2 infection among those tested     \nğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 33% ğŸ˜±\n\nâŒ If we plug in what we see (P(ğŸ§©|ğŸ¦ , ğŸ§ª) for P(ğŸ§©|ğŸ¦ )), it looks like P(ğŸ¦ |ğŸ§©) is 82.5%, when in reality it is 50%.\n\n## Thought experiment 3ï¸âƒ£: Undersampling scenario\n\nğŸ§© 20% of the population has disease X       \nğŸ¦  50% have SARS-CoV-2 infection     \nâŒ There is no relationship between disease X and SARS-CoV-2     \nğŸ§ª People with disease X are **1/2** as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLTevlUUAEvE14?format=jpg&name=medium)\n\nWhy is thought experiment 3ï¸âƒ£ bad?\n\nIt looks like:\nğŸ§ª 50% have SARS-CoV-2 infection among those tested     \nğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 11% \n\nâŒ If we plug in what we see (P(ğŸ§©|ğŸ¦ , ğŸ§ª) for P(ğŸ§©|ğŸ¦ )), it looks like P(ğŸ¦ |ğŸ§©) is 27.5%, when in reality it is 50%.\n\n## Thought experiment 4ï¸âƒ£: two problems scenario\n\nğŸ§© 20% of the population has disease X    \nğŸ¦  56% have SARS-CoV-2 infection    \nâœ… people with disease X are 1.6 times more likely to have SARS-CoV-2 infection, P(ğŸ¦ |ğŸ§©) = 80%      \nğŸ§ª People with disease X are **5** as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLUjEyUMAELWG8?format=jpg&name=medium)\n\nWhy is thought  experiment 4ï¸âƒ£ bad?\n\nIt looks like:\n\nğŸ¦ ğŸ§ª 66% have SARS-CoV-2 infection among those tested     \nğŸ§©ğŸ§ª Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 66%\n\nâŒ We're getting both the prevalence of SARS-CoV-2 **and** it's association with Disease X wrong\n\n## How can we fix this?\n\nOKAY, scenarios finished, so hopefully this highlights why we can't take the prevalence of characteristics in the **tested positive** population as the prevalence of characteristics in the overall population with a SARS-CoV-2 infection. Now, here are tips for how we can correct the numbers.\n\nScenario 2ï¸âƒ£: Oversampling by 2x\n\nğŸ‘‰ take those with disease X that tested positive for SARS-CoV-2 and downweight them by a factor of 2.\n\nâœ… the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (0.5 / 2.5) = 0.2 (20%)\n\nP(ğŸ¦ |ğŸ§©) = 50%\n\n![](https://pbs.twimg.com/media/EVLXjDhUMAE1K7_?format=jpg&name=medium)\n\nScenario 3ï¸âƒ£: Undersampling by 1/2\n\nğŸ‘‰ take those with disease X that tested positive for SARS-CoV-2 and upweight them by a factor of 2.\n\nâœ… the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (2/ 10) = 0.2 (20%)\n\nP(ğŸ¦ |ğŸ§©) = 50%\n\n![](https://pbs.twimg.com/media/EVLXmSkUMAAHZ3g?format=jpg&name=medium)\n\n\nScenario 4ï¸âƒ£: Two problems\n\nFor the prevalence of SARS-CoV-2 infections, correct by weighing by the probability of being tested in each subgroup. Here:\n\nğŸ§© = disease X    \nâŒğŸ§© = No disease X\n\nP(ğŸ¦ ) = P(ğŸ¦  | ğŸ§©) P(ğŸ§©) + P(ğŸ¦  | âŒğŸ§©) P(âŒğŸ§©) \n\nâœ…P(ğŸ¦ ) = â…˜ * 0.2 + Â½ * 0.8 = 56%\n\nSaid another way, for calculating the overall prevalence of SARS-CoV-2, this is like downweighting the oversampled Disease X people (divide by 5). \n\nâœ… P(ğŸ¦ ) = (â…˜ + 2) / (â…˜ + 2 + â…• + 2) = 0.56\n\nFor calculating the prevalence of disease X among those with SARS-CoV-2 infections:\n\nâœ… P(ğŸ§© | ğŸ¦ ) = P(ğŸ¦  | ğŸ§©) P(ğŸ§©) / P(ğŸ¦ ) = â…˜  * 0.2 / 0.56 = 0.285\n\nAgain, downweight the oversampled Disease X population (divide by 5).\n\nâœ… P(ğŸ§© | ğŸ¦ ) = â…˜ / (â…˜ + 2) = 0.285\n\nP(ğŸ¦  | ğŸ§©) = 80%\n\n![](https://pbs.twimg.com/media/EVLXqXAUEAApzdi?format=jpg&name=medium)\n\n\nHopefully this is somewhat helpful when reading about characteristics of those who are currently testing positive for SARS-CoV-2. As always, please let me know if there is something I've missed! ğŸ™",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}