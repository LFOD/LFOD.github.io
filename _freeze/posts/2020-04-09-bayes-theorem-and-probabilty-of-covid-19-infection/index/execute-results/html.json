{
  "hash": "7d815e7e30f0da03ed1f6e9e0f745a1f",
  "result": {
    "markdown": "---\ntitle: 'Bayes Theorem and the Probability of Having COVID-19'\nauthor: \"Lucy D'Agostino McGowan\"\ndate: '2020-04-09'\nslug: bayes-theorem-and-covid-19-infection\ncategories: [statistics, uncertainty, coronavirus, casual inference, bayes theorem]\ntags: [statistics, uncertainty, coronavirus, casual inference, bayes]\ndescription: \"I've seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristic's the probability of infection. Let's talk about why that's likely not true.\"\n---\n\n\nI've seen a few papers describing the characteristics of people who tested positive for SARS-CoV-2 and this is sometimes being interpreted as describing people with certain characteristic's the **probability of infection**. Let's talk about why that's likely not true.\n\n👉 Usually when thinking about estimating the prevalence of a disease, we use the **sensitivity** and **specificity** of the test to help us     \n👉 The calculations assume that everyone is equally likely to get tested, and with SARS-CoV-2 that is likely not the case\n\nLet's do some 💭 thought experiments. For these, my goal is to estimate the probability of being infected with 🦠 SARS-CoV-2 given you have 🧩 Disease X\n\nFor example,🧩 Disease X could be:    \n\n♥️ heart disease       \n😡 hypertension        \n➕ it could also be any subgroup (for example age, etc)\n\nIn these 💭 thought experiments, we don't actually have perfect information about who is infected with 🦠 SARS-CoV-2, we just know among those who are 🧪 **tested** who has been infected with 🦠 SARS-CoV-2. This is really the crux of the matter.\n\nFor these 💭 thought experiments, assume that the current tests are *perfect* (that is there are 0 false positives and 0 false negatives)\n\n☝️ Note that this is likely not the case, with the current testing framework false positives (+) are unlikely but false negatives (-) may be occurring.\n\nWe want the probability of being infected with SARS-CoV-2 given you have Disease X: P(🦠|🧩)\n\nTo get this, we need P(🧩|🦠) because based on Bayes' Theorem we know:\n\nP(🦠|🧩) = P(🧩|🦠)P(🦠) / P(🧩)\n\nBUT, instead of P(🧩|🦠), we actually have P(🧩|🦠, 🧪) - the probability of having  disease X given you have SARS-CoV-2 AND you were tested. So the crux of these thought experiments will be trying to get an accurate estimate of  P(🧩|🦠) so that we can get back to P(🦠|🧩).\n\n## Thought experiment 1️⃣: Best case scenario\n\n<label for=\"tufte-mn-\" class=\"margin-toggle\">&#8853;</label><input type=\"checkbox\" id=\"tufte-mn-\" class=\"margin-toggle\"><span class=\"marginnote\">Note: all of these numbers are made up!</span>\n🧩 20% of the population has disease X    \n🦠  50% are infected with SARS-CoV-2\n❌ There is no relationship between disease X and SARS-CoV-2      \n🧪 People with disease X are just as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLdlokU4AQauYQ?format=jpg&name=medium)\n\nWhy is thought experiment 1️⃣ a best case scenario?\n\nIt looks like:\n\n🧪 50% have SARS-CoV-2 infection among those tested    \n🧪 Of those who tested positive, the prevalence of disease X is 20%    \nP(🦠|🧩) = 50%\n\n✅ Reality (no relationship between disease X and SARS-CoV-2) matches what we see\n\n## Thought experiment 2️⃣: Oversampling scenario\n\n🧩 20% of the population has disease X\nMicrobe 50% have SARS-CoV-2 infection       \n❌ There is no relationship between disease X and SARS-CoV-2      \n🧪 People with disease X are **2x** more likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLSv4XUUAAmrVf?format=jpg&name=medium)\n\nWhy is thought experiment 2️⃣ bad?\n\nIt looks like:\n\n🧪 50% have SARS-CoV-2 infection among those tested     \n🧪 Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 33% 😱\n\n❌ If we plug in what we see (P(🧩|🦠, 🧪) for P(🧩|🦠)), it looks like P(🦠|🧩) is 82.5%, when in reality it is 50%.\n\n## Thought experiment 3️⃣: Undersampling scenario\n\n🧩 20% of the population has disease X       \n🦠 50% have SARS-CoV-2 infection     \n❌ There is no relationship between disease X and SARS-CoV-2     \n🧪 People with disease X are **1/2** as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLTevlUUAEvE14?format=jpg&name=medium)\n\nWhy is thought experiment 3️⃣ bad?\n\nIt looks like:\n🧪 50% have SARS-CoV-2 infection among those tested     \n🧪 Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 11% \n\n❌ If we plug in what we see (P(🧩|🦠, 🧪) for P(🧩|🦠)), it looks like P(🦠|🧩) is 27.5%, when in reality it is 50%.\n\n## Thought experiment 4️⃣: two problems scenario\n\n🧩 20% of the population has disease X    \n🦠 56% have SARS-CoV-2 infection    \n✅ people with disease X are 1.6 times more likely to have SARS-CoV-2 infection, P(🦠|🧩) = 80%      \n🧪 People with disease X are **5** as likely to get tested than people without disease X\n\n![](https://pbs.twimg.com/media/EVLUjEyUMAELWG8?format=jpg&name=medium)\n\nWhy is thought  experiment 4️⃣ bad?\n\nIt looks like:\n\n🦠🧪 66% have SARS-CoV-2 infection among those tested     \n🧩🧪 Of those who tested positive for SARS-CoV-2, the prevalence of disease X is 66%\n\n❌ We're getting both the prevalence of SARS-CoV-2 **and** it's association with Disease X wrong\n\n## How can we fix this?\n\nOKAY, scenarios finished, so hopefully this highlights why we can't take the prevalence of characteristics in the **tested positive** population as the prevalence of characteristics in the overall population with a SARS-CoV-2 infection. Now, here are tips for how we can correct the numbers.\n\nScenario 2️⃣: Oversampling by 2x\n\n👉 take those with disease X that tested positive for SARS-CoV-2 and downweight them by a factor of 2.\n\n✅ the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (0.5 / 2.5) = 0.2 (20%)\n\nP(🦠|🧩) = 50%\n\n![](https://pbs.twimg.com/media/EVLXjDhUMAE1K7_?format=jpg&name=medium)\n\nScenario 3️⃣: Undersampling by 1/2\n\n👉 take those with disease X that tested positive for SARS-CoV-2 and upweight them by a factor of 2.\n\n✅ the adjusted prevalence of Disease X among those that tested positive for SARS-CoV-2 (2/ 10) = 0.2 (20%)\n\nP(🦠|🧩) = 50%\n\n![](https://pbs.twimg.com/media/EVLXmSkUMAAHZ3g?format=jpg&name=medium)\n\n\nScenario 4️⃣: Two problems\n\nFor the prevalence of SARS-CoV-2 infections, correct by weighing by the probability of being tested in each subgroup. Here:\n\n🧩 = disease X    \n❌🧩 = No disease X\n\nP(🦠) = P(🦠 | 🧩) P(🧩) + P(🦠 | ❌🧩) P(❌🧩) \n\n✅P(🦠) = ⅘ * 0.2 + ½ * 0.8 = 56%\n\nSaid another way, for calculating the overall prevalence of SARS-CoV-2, this is like downweighting the oversampled Disease X people (divide by 5). \n\n✅ P(🦠) = (⅘ + 2) / (⅘ + 2 + ⅕ + 2) = 0.56\n\nFor calculating the prevalence of disease X among those with SARS-CoV-2 infections:\n\n✅ P(🧩 | 🦠) = P(🦠 | 🧩) P(🧩) / P(🦠) = ⅘  * 0.2 / 0.56 = 0.285\n\nAgain, downweight the oversampled Disease X population (divide by 5).\n\n✅ P(🧩 | 🦠) = ⅘ / (⅘ + 2) = 0.285\n\nP(🦠 | 🧩) = 80%\n\n![](https://pbs.twimg.com/media/EVLXqXAUEAApzdi?format=jpg&name=medium)\n\n\nHopefully this is somewhat helpful when reading about characteristics of those who are currently testing positive for SARS-CoV-2. As always, please let me know if there is something I've missed! 🙏",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}