{
  "hash": "08e99bb4f46ffc5ebc8d1c876b7e7a19",
  "result": {
    "markdown": "---\nauthor: \"Nick Strayer\"\ndate: 2017-01-24T10:54:24+02:00\ntitle: \"Custom JavaScript visualizations in RMarkdown\"\ndescription: \"Recently RStudio added JavaScript chunks to RMarkdown. This makes many exciting things possible. Among these things is making your own custom JavaScript visualizations of data managed in R, all without leaving the .Rmd document. This is a quick walkthrough of doing just that.\" \ncategories: [\"javascript\",\"visualization\"]\n---\n\n\n<br>\n\nI happened to stumble upon the [preview release page](https://www.rstudio.com/products/rstudio/download/preview/) for RStudio recently and noticed something that made me exorbitantly happy.  \n\n\n> A preview release of RStudio v1.0.136 is now available for testing and feedback. This release includes... Support for JavaScript and CSS chunks in R Notebooks...\n\n_\"Support for JavaScript and CSS chunks in R Notebooks\"_! As someone who loves using javascript for plotting (and secretly for manipulating) data this is massively exciting. Previously my workflow for generating an interactive graphic would be something like: \n\n- Download data\n- Clean data and do preliminary visualization in R\n- Export what I liked to a csv file and make a new directory with a set of `.html, .js, .css` files in it. \n- Load data into javascript/d3.js in the new javascript file. \n- Plot. \n\nThis workflow has served me very well, I did it probably 20 times a day when working at the New York Times and I am very fast with it. If you want to just make a stand alone visualization it's fantastic, however, as a biostatistician who works with a lot of other biostatisticians, people tend to want to see where the data comes from. \n\nWith Javascript chunks in `.Rmd` files you can explicitly show the code for data gathering/cleaning etc. in a language that your collaborators can understand, along with making custom d3 charts with that data. All without ever leaving RStudio. I will show you my quick and dirty solution to doing so. \n\n## Getting data into Javascript\n\nInstead of generating a csv file in R and then loading that into javascript we will instead send the data directly through the html to javascript. (_Note:_ This wont work well with super large data).\n\nInspired by [this](https://medium.com/@becausealice2/getting-r-and-d3-js-to-play-nicely-in-r-markdown-270e302a52d3#.772g93eb3) medium post I wrote a little function that takes a dataframe and sends it to the html document in the `.json` format. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(jsonlite)\n\nsend_df_to_js <- function(df){\n  cat(\n    paste(\n    '<script>\n      var data = ',toJSON(df),';\n    </script>'\n    , sep=\"\")\n  )\n}\n```\n:::\n\n\nTo illustrate how it works we will generate some random data into a dataframe. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Generate some random x and y data to plot\nn <- 300\nrandom_data <- data_frame(x = runif(n)*10) %>% \n  mutate(y = 0.5*x^3 - 1.3*x^2 + rnorm(n, mean = 0, sd = 80),\n         group = paste(\"group\", sample(c(1,2,3), n, replace = T)))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: `data_frame()` was deprecated in tibble 1.1.0.\nâ„¹ Please use `tibble()` instead.\n```\n\n\n:::\n:::\n\n\nNow we send a snippit of the dataframe into the function to see the output...\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrandom_data %>% \n  head() %>% \n  send_df_to_js()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<script>\n      var data = [{\"x\":8.8553,\"y\":330.51,\"group\":\"group 3\"},{\"x\":4.5664,\"y\":-43.3795,\"group\":\"group 3\"},{\"x\":6.0234,\"y\":-14.7295,\"group\":\"group 1\"},{\"x\":6.1653,\"y\":60.0903,\"group\":\"group 3\"},{\"x\":8.3446,\"y\":231.5122,\"group\":\"group 2\"},{\"x\":0.2206,\"y\":38.3577,\"group\":\"group 3\"}];\n    </script>\n```\n\n\n:::\n:::\n\n \nBeautiful, we have our data, in `json` format, wrapped in a script tag. Now we can send the whole dataframe through. This time I am using the `results = \"asis\"` option in the code chunk (`{r, results = \"asis\"}`), to write the results directly to the html document and not to the output like we did above. \n\n\n\n```{.r .cell-code}\n#Initiate data transfer protocol one\nsend_df_to_js(random_data)\n```\n\n<script>\n      var data = [{\"x\":8.8553,\"y\":330.51,\"group\":\"group 3\"},{\"x\":4.5664,\"y\":-43.3795,\"group\":\"group 3\"},{\"x\":6.0234,\"y\":-14.7295,\"group\":\"group 1\"},{\"x\":6.1653,\"y\":60.0903,\"group\":\"group 3\"},{\"x\":8.3446,\"y\":231.5122,\"group\":\"group 2\"},{\"x\":0.2206,\"y\":38.3577,\"group\":\"group 3\"},{\"x\":6.5717,\"y\":37.206,\"group\":\"group 3\"},{\"x\":6.9307,\"y\":1.4383,\"group\":\"group 2\"},{\"x\":6.7231,\"y\":107.5372,\"group\":\"group 3\"},{\"x\":1.0856,\"y\":-43.425,\"group\":\"group 1\"},{\"x\":2.1386,\"y\":109.7441,\"group\":\"group 3\"},{\"x\":1.2697,\"y\":-46.9237,\"group\":\"group 2\"},{\"x\":5.3516,\"y\":90.3602,\"group\":\"group 2\"},{\"x\":8.4483,\"y\":357.6205,\"group\":\"group 2\"},{\"x\":8.8123,\"y\":83.4692,\"group\":\"group 1\"},{\"x\":6.3492,\"y\":129.7378,\"group\":\"group 3\"},{\"x\":2.1929,\"y\":33.6826,\"group\":\"group 3\"},{\"x\":7.7233,\"y\":187.3432,\"group\":\"group 1\"},{\"x\":4.2809,\"y\":43.871,\"group\":\"group 3\"},{\"x\":9.3306,\"y\":410.7451,\"group\":\"group 3\"},{\"x\":7.6746,\"y\":105.1446,\"group\":\"group 2\"},{\"x\":3.066,\"y\":-82.9141,\"group\":\"group 3\"},{\"x\":4.166,\"y\":48.2737,\"group\":\"group 1\"},{\"x\":5.4472,\"y\":-64.4442,\"group\":\"group 2\"},{\"x\":9.9916,\"y\":279.1415,\"group\":\"group 2\"},{\"x\":4.477,\"y\":119.9579,\"group\":\"group 3\"},{\"x\":8.6121,\"y\":300.8486,\"group\":\"group 2\"},{\"x\":0.7589,\"y\":44.6904,\"group\":\"group 1\"},{\"x\":2.158,\"y\":15.0959,\"group\":\"group 3\"},{\"x\":6.383,\"y\":60.5335,\"group\":\"group 3\"},{\"x\":1.4016,\"y\":83.2527,\"group\":\"group 3\"},{\"x\":8.2175,\"y\":220.0141,\"group\":\"group 2\"},{\"x\":5.1121,\"y\":4.8068,\"group\":\"group 1\"},{\"x\":6.1233,\"y\":71.6924,\"group\":\"group 2\"},{\"x\":3.5652,\"y\":90.3434,\"group\":\"group 3\"},{\"x\":4.3715,\"y\":8.6321,\"group\":\"group 2\"},{\"x\":1.4487,\"y\":117.2707,\"group\":\"group 2\"},{\"x\":6.2583,\"y\":126.4994,\"group\":\"group 2\"},{\"x\":0.3352,\"y\":10.7976,\"group\":\"group 2\"},{\"x\":4.2168,\"y\":113.2517,\"group\":\"group 3\"},{\"x\":0.9673,\"y\":-24.7293,\"group\":\"group 2\"},{\"x\":3.7411,\"y\":108.9977,\"group\":\"group 3\"},{\"x\":3.5604,\"y\":25.7282,\"group\":\"group 1\"},{\"x\":4.1819,\"y\":-20.5187,\"group\":\"group 2\"},{\"x\":2.1253,\"y\":-99.0413,\"group\":\"group 2\"},{\"x\":1.6279,\"y\":-99.5686,\"group\":\"group 3\"},{\"x\":9.4806,\"y\":337.7363,\"group\":\"group 1\"},{\"x\":1.9507,\"y\":-80.3254,\"group\":\"group 2\"},{\"x\":6.6467,\"y\":43.3673,\"group\":\"group 2\"},{\"x\":4.8713,\"y\":22.0311,\"group\":\"group 1\"},{\"x\":5.7313,\"y\":-99.8103,\"group\":\"group 1\"},{\"x\":7.68,\"y\":94.2698,\"group\":\"group 1\"},{\"x\":2.4301,\"y\":65.2652,\"group\":\"group 3\"},{\"x\":2.4041,\"y\":-28.3487,\"group\":\"group 1\"},{\"x\":7.1608,\"y\":152.6057,\"group\":\"group 1\"},{\"x\":1.042,\"y\":-20.278,\"group\":\"group 1\"},{\"x\":7.5443,\"y\":206.5711,\"group\":\"group 3\"},{\"x\":1.1652,\"y\":-26.4914,\"group\":\"group 3\"},{\"x\":9.1621,\"y\":339.904,\"group\":\"group 3\"},{\"x\":5.0614,\"y\":-84.4637,\"group\":\"group 3\"},{\"x\":0.9151,\"y\":104.2103,\"group\":\"group 2\"},{\"x\":9.0875,\"y\":274.7023,\"group\":\"group 3\"},{\"x\":2.3815,\"y\":-55.3794,\"group\":\"group 2\"},{\"x\":2.4914,\"y\":75.1322,\"group\":\"group 3\"},{\"x\":5.9473,\"y\":105.915,\"group\":\"group 2\"},{\"x\":5.5803,\"y\":72.7248,\"group\":\"group 2\"},{\"x\":2.2477,\"y\":-19.7206,\"group\":\"group 1\"},{\"x\":6.1399,\"y\":107.586,\"group\":\"group 3\"},{\"x\":3.6867,\"y\":87.0639,\"group\":\"group 2\"},{\"x\":3.1584,\"y\":16.6483,\"group\":\"group 2\"},{\"x\":6.4993,\"y\":66.6254,\"group\":\"group 1\"},{\"x\":0.5228,\"y\":60.3141,\"group\":\"group 3\"},{\"x\":3.6084,\"y\":113.055,\"group\":\"group 3\"},{\"x\":3.2401,\"y\":18.4053,\"group\":\"group 2\"},{\"x\":6.1422,\"y\":205.9957,\"group\":\"group 1\"},{\"x\":0.2216,\"y\":-203.1635,\"group\":\"group 2\"},{\"x\":0.8032,\"y\":25.691,\"group\":\"group 1\"},{\"x\":9.2111,\"y\":259.2568,\"group\":\"group 3\"},{\"x\":6.8858,\"y\":101.9809,\"group\":\"group 2\"},{\"x\":1.3114,\"y\":-95.799,\"group\":\"group 3\"},{\"x\":0.7781,\"y\":68.318,\"group\":\"group 1\"},{\"x\":2.8723,\"y\":-38.2542,\"group\":\"group 1\"},{\"x\":4.3894,\"y\":163.8579,\"group\":\"group 3\"},{\"x\":5.1832,\"y\":6.8692,\"group\":\"group 3\"},{\"x\":9.5723,\"y\":387.4078,\"group\":\"group 2\"},{\"x\":4.3294,\"y\":226.8274,\"group\":\"group 2\"},{\"x\":3.0017,\"y\":138.7656,\"group\":\"group 2\"},{\"x\":0.5606,\"y\":47.9353,\"group\":\"group 1\"},{\"x\":5.1885,\"y\":49.2187,\"group\":\"group 3\"},{\"x\":7.1687,\"y\":122.2884,\"group\":\"group 1\"},{\"x\":8.3115,\"y\":255.9358,\"group\":\"group 3\"},{\"x\":5.5958,\"y\":-93.9592,\"group\":\"group 3\"},{\"x\":7.6851,\"y\":187.1885,\"group\":\"group 2\"},{\"x\":4.8317,\"y\":63.4544,\"group\":\"group 3\"},{\"x\":6.3377,\"y\":44.8827,\"group\":\"group 3\"},{\"x\":6.5236,\"y\":17.7505,\"group\":\"group 1\"},{\"x\":9.3406,\"y\":395.5484,\"group\":\"group 3\"},{\"x\":1.9479,\"y\":153.6171,\"group\":\"group 1\"},{\"x\":4.8344,\"y\":28.3855,\"group\":\"group 2\"},{\"x\":7.0995,\"y\":139.8943,\"group\":\"group 1\"},{\"x\":2.3413,\"y\":12.7778,\"group\":\"group 3\"},{\"x\":9.5828,\"y\":455.0446,\"group\":\"group 3\"},{\"x\":9.3127,\"y\":301.7622,\"group\":\"group 2\"},{\"x\":9.8057,\"y\":233.0247,\"group\":\"group 1\"},{\"x\":2.8886,\"y\":37.9501,\"group\":\"group 3\"},{\"x\":4.0621,\"y\":-73.7298,\"group\":\"group 1\"},{\"x\":8.6759,\"y\":287.5257,\"group\":\"group 1\"},{\"x\":2.7294,\"y\":-20.3843,\"group\":\"group 2\"},{\"x\":3.7535,\"y\":-4.9961,\"group\":\"group 2\"},{\"x\":9.8554,\"y\":247.3225,\"group\":\"group 1\"},{\"x\":2.9537,\"y\":-33.7638,\"group\":\"group 2\"},{\"x\":2.0128,\"y\":9.1719,\"group\":\"group 1\"},{\"x\":5.0332,\"y\":35.5933,\"group\":\"group 3\"},{\"x\":3.1542,\"y\":15.5896,\"group\":\"group 1\"},{\"x\":2.6603,\"y\":-46.6768,\"group\":\"group 2\"},{\"x\":6.4352,\"y\":103.4797,\"group\":\"group 2\"},{\"x\":0.0645,\"y\":71.8394,\"group\":\"group 3\"},{\"x\":3.7639,\"y\":-53.8578,\"group\":\"group 2\"},{\"x\":4.582,\"y\":22.4999,\"group\":\"group 3\"},{\"x\":7.7233,\"y\":34.6157,\"group\":\"group 1\"},{\"x\":5.3577,\"y\":31.1561,\"group\":\"group 2\"},{\"x\":3.4621,\"y\":2.9042,\"group\":\"group 1\"},{\"x\":7.9288,\"y\":187.7183,\"group\":\"group 2\"},{\"x\":4.5558,\"y\":37.1252,\"group\":\"group 2\"},{\"x\":9.8474,\"y\":391.2504,\"group\":\"group 3\"},{\"x\":3.5608,\"y\":-5.1083,\"group\":\"group 2\"},{\"x\":9.2386,\"y\":164.8407,\"group\":\"group 1\"},{\"x\":3.2046,\"y\":54.7993,\"group\":\"group 1\"},{\"x\":7.2311,\"y\":298.5368,\"group\":\"group 1\"},{\"x\":5.9899,\"y\":201.2763,\"group\":\"group 1\"},{\"x\":2.9668,\"y\":17.9737,\"group\":\"group 1\"},{\"x\":1.3432,\"y\":-38.5567,\"group\":\"group 3\"},{\"x\":8.0211,\"y\":205.9556,\"group\":\"group 2\"},{\"x\":4.1633,\"y\":-76.0189,\"group\":\"group 3\"},{\"x\":0.557,\"y\":54.5101,\"group\":\"group 3\"},{\"x\":5.4673,\"y\":146.4503,\"group\":\"group 1\"},{\"x\":6.3067,\"y\":103.7337,\"group\":\"group 3\"},{\"x\":0.8446,\"y\":129.9164,\"group\":\"group 1\"},{\"x\":9.2546,\"y\":287.4047,\"group\":\"group 2\"},{\"x\":3.4935,\"y\":-106.966,\"group\":\"group 3\"},{\"x\":7.9217,\"y\":150.8765,\"group\":\"group 3\"},{\"x\":2.3729,\"y\":17.2203,\"group\":\"group 1\"},{\"x\":6.7358,\"y\":19.2544,\"group\":\"group 2\"},{\"x\":1.7074,\"y\":-29.1189,\"group\":\"group 2\"},{\"x\":7.9338,\"y\":190.6445,\"group\":\"group 3\"},{\"x\":9.9637,\"y\":615.5708,\"group\":\"group 3\"},{\"x\":8.0497,\"y\":158.7772,\"group\":\"group 3\"},{\"x\":4.7538,\"y\":71.6372,\"group\":\"group 3\"},{\"x\":1.6874,\"y\":83.9007,\"group\":\"group 2\"},{\"x\":1.6015,\"y\":71.4369,\"group\":\"group 2\"},{\"x\":7.0714,\"y\":78.6677,\"group\":\"group 1\"},{\"x\":7.3711,\"y\":152.3604,\"group\":\"group 1\"},{\"x\":3.1261,\"y\":-88.6202,\"group\":\"group 2\"},{\"x\":0.5002,\"y\":-123.1706,\"group\":\"group 2\"},{\"x\":2.7357,\"y\":-45.3425,\"group\":\"group 1\"},{\"x\":1.9926,\"y\":37.0196,\"group\":\"group 1\"},{\"x\":0.0404,\"y\":-15.5903,\"group\":\"group 3\"},{\"x\":9.3582,\"y\":310.0854,\"group\":\"group 3\"},{\"x\":2.3591,\"y\":36.1196,\"group\":\"group 1\"},{\"x\":8.41,\"y\":200.9803,\"group\":\"group 3\"},{\"x\":2.4126,\"y\":72.4713,\"group\":\"group 2\"},{\"x\":6.1156,\"y\":-24.7838,\"group\":\"group 2\"},{\"x\":2.9851,\"y\":-40.9941,\"group\":\"group 1\"},{\"x\":2.4161,\"y\":-48.7025,\"group\":\"group 2\"},{\"x\":9.8657,\"y\":289.7662,\"group\":\"group 1\"},{\"x\":1.793,\"y\":-24.0538,\"group\":\"group 2\"},{\"x\":5.7706,\"y\":-28.8629,\"group\":\"group 2\"},{\"x\":6.251,\"y\":-38.6925,\"group\":\"group 3\"},{\"x\":8.3669,\"y\":152.9708,\"group\":\"group 3\"},{\"x\":7.2356,\"y\":215.547,\"group\":\"group 2\"},{\"x\":6.3191,\"y\":22.6213,\"group\":\"group 1\"},{\"x\":8.5984,\"y\":232.4501,\"group\":\"group 2\"},{\"x\":1.4295,\"y\":-9.1413,\"group\":\"group 1\"},{\"x\":0.3957,\"y\":108.0279,\"group\":\"group 1\"},{\"x\":4.0835,\"y\":32.5657,\"group\":\"group 1\"},{\"x\":6.0359,\"y\":4.7083,\"group\":\"group 3\"},{\"x\":9.4042,\"y\":296.9669,\"group\":\"group 3\"},{\"x\":6.5545,\"y\":73.8971,\"group\":\"group 3\"},{\"x\":4.8755,\"y\":25.0529,\"group\":\"group 2\"},{\"x\":0.1421,\"y\":43.751,\"group\":\"group 2\"},{\"x\":1.4646,\"y\":-134.7592,\"group\":\"group 2\"},{\"x\":8.7315,\"y\":273.5709,\"group\":\"group 3\"},{\"x\":5.5312,\"y\":111.2437,\"group\":\"group 2\"},{\"x\":8.4418,\"y\":38.7701,\"group\":\"group 1\"},{\"x\":7.4936,\"y\":35.3469,\"group\":\"group 3\"},{\"x\":0.6525,\"y\":-18.7837,\"group\":\"group 1\"},{\"x\":6.059,\"y\":68.5058,\"group\":\"group 1\"},{\"x\":6.7078,\"y\":122.9134,\"group\":\"group 2\"},{\"x\":5.5811,\"y\":-87.6854,\"group\":\"group 2\"},{\"x\":7.5153,\"y\":-77.7503,\"group\":\"group 2\"},{\"x\":6.4597,\"y\":98.4276,\"group\":\"group 3\"},{\"x\":9.1952,\"y\":369.1896,\"group\":\"group 1\"},{\"x\":3.816,\"y\":44.3528,\"group\":\"group 3\"},{\"x\":7.8351,\"y\":216.3799,\"group\":\"group 3\"},{\"x\":5.0932,\"y\":139.526,\"group\":\"group 2\"},{\"x\":7.9746,\"y\":149.0239,\"group\":\"group 1\"},{\"x\":6.0419,\"y\":57.5786,\"group\":\"group 1\"},{\"x\":2.4206,\"y\":108.0075,\"group\":\"group 2\"},{\"x\":8.193,\"y\":304.6129,\"group\":\"group 3\"},{\"x\":2.3191,\"y\":118.6614,\"group\":\"group 2\"},{\"x\":2.962,\"y\":176.6573,\"group\":\"group 1\"},{\"x\":1.328,\"y\":42.8881,\"group\":\"group 3\"},{\"x\":2.9579,\"y\":-7.2085,\"group\":\"group 2\"},{\"x\":1.8582,\"y\":-76.3284,\"group\":\"group 3\"},{\"x\":2.2021,\"y\":28.1607,\"group\":\"group 2\"},{\"x\":6.0394,\"y\":129.496,\"group\":\"group 1\"},{\"x\":2.834,\"y\":-75.608,\"group\":\"group 1\"},{\"x\":9.0541,\"y\":195.3445,\"group\":\"group 2\"},{\"x\":2.7008,\"y\":20.659,\"group\":\"group 2\"},{\"x\":9.224,\"y\":78.8215,\"group\":\"group 2\"},{\"x\":5.8193,\"y\":22.6738,\"group\":\"group 3\"},{\"x\":4.8771,\"y\":74.4601,\"group\":\"group 3\"},{\"x\":4.1523,\"y\":-57.2771,\"group\":\"group 3\"},{\"x\":2.0525,\"y\":-36.2893,\"group\":\"group 1\"},{\"x\":2.0657,\"y\":38.2164,\"group\":\"group 2\"},{\"x\":8.0298,\"y\":214.4074,\"group\":\"group 1\"},{\"x\":2.1668,\"y\":13.0164,\"group\":\"group 3\"},{\"x\":0.0918,\"y\":-29.0775,\"group\":\"group 2\"},{\"x\":9.2288,\"y\":55.8113,\"group\":\"group 2\"},{\"x\":2.8854,\"y\":82.3051,\"group\":\"group 3\"},{\"x\":3.4011,\"y\":19.9022,\"group\":\"group 2\"},{\"x\":4.4097,\"y\":50.3214,\"group\":\"group 2\"},{\"x\":9.0463,\"y\":267.1996,\"group\":\"group 2\"},{\"x\":4.9465,\"y\":-37.3005,\"group\":\"group 3\"},{\"x\":7.1862,\"y\":21.8024,\"group\":\"group 2\"},{\"x\":7.9844,\"y\":215.1951,\"group\":\"group 3\"},{\"x\":8.6488,\"y\":264.4042,\"group\":\"group 1\"},{\"x\":4.4433,\"y\":122.4434,\"group\":\"group 3\"},{\"x\":5.4466,\"y\":89.9124,\"group\":\"group 3\"},{\"x\":0.7865,\"y\":41.9639,\"group\":\"group 3\"},{\"x\":8.2648,\"y\":202.7221,\"group\":\"group 3\"},{\"x\":2.7585,\"y\":-40.2802,\"group\":\"group 2\"},{\"x\":9.8006,\"y\":467.8655,\"group\":\"group 3\"},{\"x\":6.1119,\"y\":63.2137,\"group\":\"group 2\"},{\"x\":7.2159,\"y\":116.4437,\"group\":\"group 1\"},{\"x\":5.5184,\"y\":144.1208,\"group\":\"group 3\"},{\"x\":1.9238,\"y\":-28.3956,\"group\":\"group 2\"},{\"x\":9.0902,\"y\":422.3308,\"group\":\"group 1\"},{\"x\":6.8537,\"y\":-5.6991,\"group\":\"group 2\"},{\"x\":8.0103,\"y\":81.2415,\"group\":\"group 2\"},{\"x\":5.7465,\"y\":154.7533,\"group\":\"group 1\"},{\"x\":8.2569,\"y\":36.7723,\"group\":\"group 3\"},{\"x\":3.1259,\"y\":-4.4733,\"group\":\"group 3\"},{\"x\":1.53,\"y\":-3.6536,\"group\":\"group 2\"},{\"x\":6.14,\"y\":68.0283,\"group\":\"group 1\"},{\"x\":0.6731,\"y\":143.9382,\"group\":\"group 3\"},{\"x\":5.3241,\"y\":64.3429,\"group\":\"group 2\"},{\"x\":8.6199,\"y\":356.8495,\"group\":\"group 2\"},{\"x\":5.1542,\"y\":9.2985,\"group\":\"group 1\"},{\"x\":7.7086,\"y\":250.4137,\"group\":\"group 1\"},{\"x\":0.8279,\"y\":-13.4732,\"group\":\"group 1\"},{\"x\":6.5389,\"y\":137.5918,\"group\":\"group 2\"},{\"x\":0.5525,\"y\":-38.3458,\"group\":\"group 3\"},{\"x\":5.697,\"y\":36.3064,\"group\":\"group 1\"},{\"x\":8.478,\"y\":155.7048,\"group\":\"group 1\"},{\"x\":4.4436,\"y\":16.2834,\"group\":\"group 1\"},{\"x\":8.9565,\"y\":260.5466,\"group\":\"group 1\"},{\"x\":6.8684,\"y\":112.9201,\"group\":\"group 1\"},{\"x\":6.0453,\"y\":-9.4415,\"group\":\"group 2\"},{\"x\":9.255,\"y\":170.7386,\"group\":\"group 2\"},{\"x\":7.4097,\"y\":206.7564,\"group\":\"group 1\"},{\"x\":0.2953,\"y\":77.253,\"group\":\"group 3\"},{\"x\":5.0149,\"y\":-63.164,\"group\":\"group 2\"},{\"x\":5.6614,\"y\":97.03,\"group\":\"group 3\"},{\"x\":8.776,\"y\":143.0522,\"group\":\"group 1\"},{\"x\":2.599,\"y\":-58.4725,\"group\":\"group 1\"},{\"x\":3.0754,\"y\":-23.7358,\"group\":\"group 2\"},{\"x\":7.0395,\"y\":69.602,\"group\":\"group 2\"},{\"x\":6.3094,\"y\":-5.7051,\"group\":\"group 1\"},{\"x\":9.721,\"y\":377.5347,\"group\":\"group 3\"},{\"x\":2.1051,\"y\":-55.2424,\"group\":\"group 3\"},{\"x\":3.0413,\"y\":-69.8129,\"group\":\"group 1\"},{\"x\":7.8464,\"y\":26.4492,\"group\":\"group 3\"},{\"x\":4.2232,\"y\":6.4293,\"group\":\"group 2\"},{\"x\":0.9374,\"y\":7.4401,\"group\":\"group 1\"},{\"x\":0.7998,\"y\":46.6993,\"group\":\"group 2\"},{\"x\":4.8121,\"y\":-26.7319,\"group\":\"group 1\"},{\"x\":8.6718,\"y\":192.3622,\"group\":\"group 1\"},{\"x\":8.1279,\"y\":209.5755,\"group\":\"group 2\"},{\"x\":4.2867,\"y\":-89.5703,\"group\":\"group 2\"},{\"x\":9.8498,\"y\":249.719,\"group\":\"group 2\"},{\"x\":3.4865,\"y\":-120.9071,\"group\":\"group 3\"},{\"x\":5.2175,\"y\":80.4257,\"group\":\"group 3\"},{\"x\":2.4788,\"y\":-99.7238,\"group\":\"group 3\"},{\"x\":6.2139,\"y\":-11.1271,\"group\":\"group 1\"},{\"x\":2.4504,\"y\":-0.3787,\"group\":\"group 3\"},{\"x\":6.3602,\"y\":80.8601,\"group\":\"group 2\"},{\"x\":7.2032,\"y\":237.7655,\"group\":\"group 2\"},{\"x\":4.1297,\"y\":19.2227,\"group\":\"group 3\"},{\"x\":6.7014,\"y\":162.1015,\"group\":\"group 2\"},{\"x\":1.8147,\"y\":76.8115,\"group\":\"group 1\"},{\"x\":2.4278,\"y\":131.581,\"group\":\"group 1\"},{\"x\":7.8336,\"y\":218.1809,\"group\":\"group 2\"},{\"x\":0.5138,\"y\":-7.0409,\"group\":\"group 2\"},{\"x\":0.7769,\"y\":147.6759,\"group\":\"group 1\"},{\"x\":0.1103,\"y\":-19.7154,\"group\":\"group 2\"},{\"x\":7.9831,\"y\":164.37,\"group\":\"group 2\"},{\"x\":8.6398,\"y\":277.3148,\"group\":\"group 3\"},{\"x\":1.0014,\"y\":-46.5887,\"group\":\"group 2\"},{\"x\":4.7016,\"y\":49.6086,\"group\":\"group 3\"}];\n    </script>\n\n\nNow our data is inside our page's javascript scope and ready to be played with! \n\n## Drawing pretty pictures\n\nLet's make a super simple d3 scatter plot to see this randomly generated data. All I have to do is include my desired javascript libraries, make a `div` element for my visualization to go into and then put my `{js}` block in. RMarkdown will slot the javascript into the page and we're good to go.  \n\nIn this example I did...\n\n```\n<script src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n<script src=\"https://d3js.org/d3.v4.min.js\"></script>\n\n<div id = \"viz\"></div> \n\n` ` `{js}\n//code goes here\n` ` `\n```\n\n## Did it work? \n\n<script src=\"https://code.jquery.com/jquery-3.1.1.min.js\"></script>\n<script src=\"https://d3js.org/d3.v4.min.js\"></script>\n\n\n<div id = \"viz\"></div> \n\n\n::: {.cell}\n\n```{.js .cell-code}\nvar point_vals = d3.select(\"#viz\")\n  .append(\"p\")\n  .attr(\"align\", \"center\")\n  .text(\"Mouseover some data!\");\n\n//Get how wide our page is in pixels so we can draw our plot in it\nvar page_width = $(\"#did-it-work\").width();\n  \n// set the dimensions and margins of the graph\nvar margin = 30,\n    width = page_width - 2*margin,\n    height = page_width*0.8 - 2*margin;\n    \n// Find max data values\nvar x_extent = d3.extent(data, d => d.x);\nvar y_extent = d3.extent(data, d => d.y);\n\n// Set the scales \nvar x = d3.scaleLinear()\n  .domain(x_extent)\n  .range([0, width]);\n  \nvar y = d3.scaleLinear()\n  .domain(y_extent)\n  .range([height, 0]);\n\n//Set up our SVG element\nvar svg = d3.select(\"#viz\").append(\"svg\")\n    .attr(\"width\", width + 2*margin)\n    .attr(\"height\", height + 2*margin)\n  .append(\"g\")\n    .attr(\"transform\",\n          \"translate(\" + margin + \",\" + margin + \")\");\n\nvar bounce_select = d3.transition()\n    .duration(1000)\n    .ease(d3.easeElastic.period(0.4));\n    \n// Add the scatterplot\nsvg.selectAll(\".dots\")\n    .data(data)\n  .enter().append(\"circle\")\n    .attr(\"class\", \"dots\")\n    .attr(\"fill\", d => d.group === \"group 1\"? \"steelblue\":\"orangered\")\n    .attr(\"fill-opacity\", 0.3)\n    .attr(\"r\", 5)\n    .attr(\"cx\", d => x(d.x) )\n    .attr(\"cy\", d => y(d.y) )\n    .on(\"mouseover\", function(d){\n       d3.selectAll(\".dots\").attr(\"r\", 5) //make sure all the dots are small\n       d3.select(this)\n        .transition(bounce_select)\n        .attr(\"r\", 10);\n      \n       point_vals.text(\"X:\" + d.x + \" Y:\" + d.y) //change the title of the graph to the datapoint\n    });\n    \n// Draw the axes    \n// Add the X Axis\nsvg.append(\"g\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(x));\n\n// Add the Y Axis\nsvg.append(\"g\")\n    .call(d3.axisLeft(y));\n```\n\n\n<script type=\"text/javascript\">\nvar point_vals = d3.select(\"#viz\")\n  .append(\"p\")\n  .attr(\"align\", \"center\")\n  .text(\"Mouseover some data!\");\n\n//Get how wide our page is in pixels so we can draw our plot in it\nvar page_width = $(\"#did-it-work\").width();\n  \n// set the dimensions and margins of the graph\nvar margin = 30,\n    width = page_width - 2*margin,\n    height = page_width*0.8 - 2*margin;\n    \n// Find max data values\nvar x_extent = d3.extent(data, d => d.x);\nvar y_extent = d3.extent(data, d => d.y);\n\n// Set the scales \nvar x = d3.scaleLinear()\n  .domain(x_extent)\n  .range([0, width]);\n  \nvar y = d3.scaleLinear()\n  .domain(y_extent)\n  .range([height, 0]);\n\n//Set up our SVG element\nvar svg = d3.select(\"#viz\").append(\"svg\")\n    .attr(\"width\", width + 2*margin)\n    .attr(\"height\", height + 2*margin)\n  .append(\"g\")\n    .attr(\"transform\",\n          \"translate(\" + margin + \",\" + margin + \")\");\n\nvar bounce_select = d3.transition()\n    .duration(1000)\n    .ease(d3.easeElastic.period(0.4));\n    \n// Add the scatterplot\nsvg.selectAll(\".dots\")\n    .data(data)\n  .enter().append(\"circle\")\n    .attr(\"class\", \"dots\")\n    .attr(\"fill\", d => d.group === \"group 1\"? \"steelblue\":\"orangered\")\n    .attr(\"fill-opacity\", 0.3)\n    .attr(\"r\", 5)\n    .attr(\"cx\", d => x(d.x) )\n    .attr(\"cy\", d => y(d.y) )\n    .on(\"mouseover\", function(d){\n       d3.selectAll(\".dots\").attr(\"r\", 5) //make sure all the dots are small\n       d3.select(this)\n        .transition(bounce_select)\n        .attr(\"r\", 10);\n      \n       point_vals.text(\"X:\" + d.x + \" Y:\" + d.y) //change the title of the graph to the datapoint\n    });\n    \n// Draw the axes    \n// Add the X Axis\nsvg.append(\"g\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(x));\n\n// Add the Y Axis\nsvg.append(\"g\")\n    .call(d3.axisLeft(y));\n</script>\n:::\n\n\n \n## Why/ When\n\nThis is a bad example of a visualization for this scenario as something like plotly could do this in much less effort. If you're doing something more complicated/ bespoke then this is a great resource to have. \n\n## Addendum \n\nIf you're interested, here's the javascript code I included to make the above graph. \n\n```\nvar point_vals = d3.select(\"#viz\").append(\"p\").text(\"Mouseover some data!\");\n\n//Get how wide our page is in pixels so we can draw our plot in it\nvar page_width = $(\"#did-it-work\").width();\n  \n// set the dimensions and margins of the graph\nvar margin = 20,\n    width = page_width - 2*margin,\n    height = page_width*0.8 - 2*margin;\n    \n// Find max data values\nvar x_extent = d3.extent(data, d => d.x);\nvar y_extent = d3.extent(data, d => d.y);\n\n// Set the scales \nvar x = d3.scaleLinear()\n  .domain(x_extent)\n  .range([0, width]);\n  \nvar y = d3.scaleLinear()\n  .domain(y_extent)\n  .range([height, 0]);\n\n//Set up our SVG element\nvar svg = d3.select(\"#viz\").append(\"svg\")\n    .attr(\"width\", width + 2*margin)\n    .attr(\"height\", height + 2*margin)\n  .append(\"g\")\n    .attr(\"transform\",\n          \"translate(\" + margin + \",\" + margin + \")\");\n\nvar bounce_select = d3.transition()\n    .duration(1000)\n    .ease(d3.easeElastic.period(0.4));\n    \n// Add the scatterplot\nsvg.selectAll(\".dots\")\n    .data(data)\n  .enter().append(\"circle\")\n    .attr(\"class\", \"dots\")\n    .attr(\"fill\", d => d.group === \"group 1\"? \"steelblue\":\"orangered\")\n    .attr(\"fill-opacity\", 0.3)\n    .attr(\"r\", 5)\n    .attr(\"cx\", d => x(d.x) )\n    .attr(\"cy\", d => y(d.y) )\n    .on(\"mouseover\", function(d){\n       d3.selectAll(\".dots\").attr(\"r\", 5) //make sure all the dots are small\n       d3.select(this)\n        .transition(bounce_select)\n        .attr(\"r\", 10);\n      \n       point_vals.text(\"X:\" + d.x + \" Y:\" + d.y) //change the title of the graph to the datapoint\n    });\n    \n// Draw the axes    \n// Add the X Axis\nsvg.append(\"g\")\n    .attr(\"transform\", \"translate(0,\" + height + \")\")\n    .call(d3.axisBottom(x));\n\n// Add the Y Axis\nsvg.append(\"g\")\n    .call(d3.axisLeft(y));\n```",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}