{
  "hash": "1d26339938249c60a933097e57b60ae7",
  "result": {
    "markdown": "---\ntitle: \"Happy World Emoji Day: an analysis of rOpenSci's Slack emojis\"\nauthor: \"Lucy D'Agostino McGowan\"\ndate: '2017-07-17'\nslug: ropensci-slack-emojis\ncategories: [\"rOpenSci\", \"rstats\", \"emojis\"]\ntags: [\"rOpenSci\", \"rstats\", \"emojis\"]\ndescription: HAPPY world emoji day! In honor of this momentous occasion, I have decided to analyze the emojis used on rOpenSci's Slack.\n---\n\n\nHAPPY world emoji day! üåç üêî üìÜ\n\nIn honor of this momentous occasion, I have decided to analyze the emojis used on [rOpenSci](https://ropensci.org)'s Slack. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"dplyr\")\n```\n:::\n\n\n::: column-margin\nIf you'd like to follow along, go fetch yourself a [Slack token](https://api.slack.com/tokens).\n:::\n\n```r\ntoken <- \"MY_SLACK_API_TOKEN\" ## stick your token here\n```\n\nWe will first use Slack's [`reactions.list`](https://api.slack.com/methods/reactions.list) method.\n\n::: column-margin\nNotice here I am pulling the items from the response and then from each item I am interested in the message reactions. This ignores the reactions on files and comments.\n:::\n\n```r\nreq_lst <- httr::POST(\n  \"https://slack.com/api/reactions.list\",\n  body = list(\n   token = token,\n   count = 500\n   )) %>%\n  httr::content() %>%\n  .$items %>%\n  purrr::map(~.[[\"message\"]][[\"reactions\"]])\n```\n\nLet's pull out the `name` and `count` of each emoji used and stick it in a `tibble` üéâ. \n```r\ntbl <- tibble::tibble(\n  name = purrr::map_chr(purrr::flatten(req_lst), \"name\"),\n  count = purrr::map_int(purrr::flatten(req_lst), \"count\")\n)\n```\n\nOne of the most delightful features in Slack is the ability to create custom emojis! In order to be able to display both ordinary and custom emojis, I can pull in a list of all emojis we have customized in the rOpenSci Slack team using the [`emoji.list`](https://api.slack.com/methods/emoji.list) method.\n\n::: column-margin\nNotice here I am using the `tibble::enframe()` function. This is an awesome way to convert a vector or list to a two-column data frame.\n:::\n\n```r\nemojis_tbl <- httr::POST(\n  \"https://slack.com/api/emoji.list\",\n  body = list(token = token)\n  ) %>%\n  httr::content() %>%\n  .$emoji %>%\n  tibble::enframe() %>%\n  mutate(value = unlist(value))\n```\n\n\n::: {.cell}\n\n:::\n\n\nThe `emojis_tbl` data frame contains the name of each custom emoji and a link to their associated image. Here I create a small function that will either read that image using the [`magick`](https://github.com/ropensci/magick) package or, if it is an ordinary emoji, use the [`emo`](https://github.com/hadley/emo) package to look it up.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nread_emoji <- function(x, y) {\n  if (!is.na(x)) {\n    magick::image_read(x)\n  } else {\n    emo::ji(y)\n  }\n}\n```\n:::\n\n\nLet's do a wee bit of data wrangling üöú to sort out which emojis are used the most.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntop_emojis <- tbl %>%\n  group_by(name) %>%\n  summarise(count = sum(count)) %>%\n  arrange(desc(count)) %>%\n  slice(1:10) %>%\n  left_join(emojis_tbl, by = \"name\") %>%\n  mutate(emoji = purrr::map2(value, name, read_emoji))\n```\n:::\n\n\nI have written another small function to make sure the custom emojis print properly when I render my output.\n\n::: column-margin\nNote, if you are doing this for your blog, rather than saving a temporary file as I have demonstrated here, you should save this as a relative file path in your blog üå≥.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrender_emoji <- function(x, y) {\n  if (inherits(x, \"magick-image\")) {\n    tmp <- tempfile(fileext = \".gif\")\n    x <- magick::image_scale(x, \"25x25\")\n    magick::image_write(x, path = tmp)\n    emoji <- rep(glue::glue(\"![]({tmp})\"), as.integer(y/7))\n    print(glue::glue(\"{glue::glue_collapse(emoji)}: {y}\\n\\n\"))\n  } else {\n    emoji <- rep(x, as.integer(y/7))\n    print(glue::glue(\"{glue::glue_collapse(emoji)}: {y}\\n\\n\"))\n  }\n}\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nNow let's walk it out üíÉ.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npurrr::walk2(top_emojis$emoji, top_emojis$count, render_emoji)\n```\n:::\n\n::: {.cell}\n\n:::\n\n [1] \"üëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëãüëã: 130\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \n [2] \"üëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëçüëç: 129\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         \n [3] \"‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è: 83\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   \n [4] \"![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif)![](../../media/images/ropensci_custom_emoji75.gif): 75\\n\"\n [5] \"üéâüéâüéâüéâüéâüéâüéâüéâüéâ: 65\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            \n [6] \"üêìüêìüêìüêìüêì: 36\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    \n [7] \"üòÇüòÇüòÇüòÇ: 34\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n [8] \"‚ûï‚ûï‚ûï‚ûï: 29\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n [9] \"üçªüçªüçªüçª: 28\\n\"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \n[10] \"![](../../media/images/ropensci_custom_emoji27.gif)![](../../media/images/ropensci_custom_emoji27.gif)![](../../media/images/ropensci_custom_emoji27.gif): 27\\n\"                                                                                                                                                                                                                                                                                                                                                                     \n\n\n\n\nHow delightful! It is no surprise that the üëã is the most popular emoji used, since rOpenSci is an extraordinarily welcoming crew! In fact the community organizer, [Stefanie](https://twitter.com/StefanieButland), just wrote a blog post about our Slack [#welcome channel](https://blog.trelliscience.com/the-value-of-welcome/). I am (obviously) very proud to see that üêì makes a strong appearance ([#rchickenladies](https://twitter.com/search?src=typd&q=%23rchickenladies)), and of course delighted to see our Aussie friends getting represented by the Aussie party parrot. \n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}