<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lucy D‚ÄôAgostino McGowan">
<meta name="dcterms.date" content="2022-02-20">
<meta name="description" content="This post explores the impact of setting particular criteria for ‚Äòsuccess‚Äô in clinical trial designs, with a specific example from the recent vaccine immunobridging trials.">

<title>Exploring the impacts of noninferiority trial thresholds ‚Äì</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-6cec2fdee09017336b8dae9dbd66990d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-92165973-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.9.1/d3.min.js"></script>

<style>
  #custom-header {
    height: 30vh;
    width: 100%;
    position:relative;
    z-index:1;
    margin:0 auto;
  }
</style>


<meta property="og:title" content="Exploring the impacts of noninferiority trial thresholds ‚Äì">
<meta property="og:description" content="This post explores the impact of setting particular criteria for ‚Äòsuccess‚Äô in clinical trial designs, with a specific example from the recent vaccine immunobridging trials.">
<meta property="og:image" content="https://www.livefreeordichotomize.com/posts/2022-02-20-exploring-impacts-of-noninferiority-thresholds/index_files/figure-html/unnamed-chunk-2-1.png">
<meta property="og:site_name" content=" ">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Live Free or Dichotomize">
<meta name="twitter:description" content="This post explores the impact of setting particular criteria for ‚Äòsuccess‚Äô in clinical trial designs, with a specific example from the recent vaccine immunobridging trials.">
<meta name="twitter:image" content="https://www.livefreeordichotomize.com/posts/2022-02-20-exploring-impacts-of-noninferiority-thresholds/media/lfod-card.png">
<meta name="twitter:creator" content="@LucyStats">
<meta name="twitter:card" content="summary_large_image">
</head><body class="nav-fixed quarto-light"><header id="custom-header">
  <div id="header_viz"></div>
</header>

<script>
  $( document ).ready(() => {

    //javascript for intro loader

    //Function to immitate R's seq
    function seq(start, end, increment) {
      var length = Math.round((end - start)/increment);
      return Array(length).fill().map((_, idx) => start + idx*increment)
    }


    //define the pdf of the distribution.
    var logistic = function(x, theta, i) {
        var mu = 0.1;
        sign = 1
        var y = sign * (1 / (Math.sqrt(2 * Math.PI) * theta)) * (1 / x) *
            Math.exp(-Math.pow((Math.log(x) - mu), 2) / (2 * Math.pow(theta, 2)))
        return y;
    }

    var width   = $("#custom-header").width() ,
        height  = $("#custom-header").outerHeight(),
        padding = 0,
        numOfLines = 20,
        xs = seq(0.01, 5, .01),
        colors = ['rgb(165,0,38)', 'rgb(215,48,39)', 'rgb(244,109,67)', 'rgb(253,174,97)', 'rgb(254,224,144)',
            'rgb(224,243,248)', 'rgb(171,217,233)', 'rgb(116,173,209)', 'rgb(69,117,180)', 'rgb(49,54,149)'
        ];
  
    console.log("trying to run this shit.")
    //define the svg.
    var svg = d3.select("#header_viz").append("svg")
        .attr("width", width)
        .attr("height", height + 2 * padding)
        .append("g")


    var animatelines = function(whichline) {
        d3.selectAll(".line").style("opacity","0.5");

        //Select All of the lines and process them one by one
        d3.selectAll(".line").each(function(d,i){
            // Get the length of each line in turn
            var totalLength = d3.select("#line" + i).node().getTotalLength();

            d3.selectAll("#line" + i).attr("stroke-dasharray", totalLength + " " + totalLength)
              .attr("stroke-dashoffset", totalLength)
              .transition()
              .duration(5000)
              .delay(100*i)
              .attr("stroke-dashoffset", 0)
              .style("stroke-width",2)
        })

        writeGreeting()
    }



    // The Scales:
    var thetaMap = d3.scaleLinear() //name the values from 0 to 20 and make their values from .1-.7
        .domain([0, numOfLines])
        .range([0.8, 0.085])

    var yPos = d3.scaleLinear() //scalling for creating horizontal lines
        .domain([0, numOfLines])
        .range([0, 4])

    var x = d3.scaleLinear()
        .domain([0, 5])
        .range([0, width]);

    var y = d3.scaleLinear()
        .domain([0, 4.5])
        .range([height, 0]);

    // The line functions:
    var logistic = d3.range(numOfLines).map(function(i) {
        var odd = true
        var toReturn = xs.map(function(num) {
            return {
                "x": num,
                "y": logistic(num, thetaMap(i), i)
            }
        })
        return toReturn;
    })

    //make a greeting message for after the line animation.
    function writeGreeting(){

        var text_scale = width < 500 ? 1 : 0.65;
        console.log(text_scale);
        var intro_text = "Live Free or Dichotomize";

        var title = svg.append("text")
            .attr("font-size", 30)
            .attr("font-family", "optima")
            .attr("text-anchor", "end")
            .attr("fill-opacity", 0.65)
            .attr("x", width < 500 ? x(4.8) : x(4.2))
            .attr("y", width < 500 ? y(3.12) : y(2.1) )
            .attr("opacity", 0)
            .text(intro_text)
            .attr("font-size", function(d) { return ( text_scale*width - 8) / this.getComputedTextLength() * 24 + "px"; })
            .text("")
            .attr("opacity", 1);

        (function drawGreeting (i, start, greeting) {
            setTimeout(function () {

                //add next letter to the greeting in progress
                start += greeting[i];

                title.html(start) //append this to the html

                if (start.length < greeting.length) { //if the in progress greeting is less than the full, keep going.
                    drawGreeting(i+1,start,greeting);      //  increment i and call again.
                };
            }, 100)
        })(0, "", intro_text);
    }


    // The d3 stuff
    var line = d3.line()
        // .interpolate("basis")
        .x(function(d) { return x(d.x); })
        .y(function(d) { return y(d.y); });


    svg.selectAll(".line")
        .data(logistic)
        .enter().append("path")
        .attr("class", "line")
        .attr("id" , function(d, i){ return "line" + i;})
        .attr("d", line)
        .style("stroke-width", 2)
        .style("stroke", function(d, i) { return colors[i % 10] })
        .style("opacity", 0)
        .style("fill", "none")
        .on("mouseover", function(d){
            d3.select(this).style("stroke", "black")
        })
        .on("mouseout", function(d,i){
            d3.select(this).style("stroke", colors[i % 10])
        })

    // var introMessage = isMobile ? "tap" : "click"
    // var introMessage = "click"
    //
    // var intro = svg.append("text")
    //     .text(introMessage)
    //     .attr("font-size", 35)
    //     .attr("font-family", "optima")
    //     .attr("text-anchor", "middle")
    //     .attr("x", x(2.5))
    //     .attr("y", y(2.01))

    //kick it off on a click. (or tap)
    animatelines(2)
    // d3.select("svg").on("click", function() { animatelines(2) })

})

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>





<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title"></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring the impacts of noninferiority trial thresholds</h1>
</div>

<div>
  <div class="description">
    This post explores the impact of setting particular criteria for ‚Äòsuccess‚Äô in clinical trial designs, with a specific example from the recent vaccine immunobridging trials.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Lucy D‚ÄôAgostino McGowan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 20, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This post explores the impact of setting particular criteria for ‚Äúsuccess‚Äù in clinical trial designs. A common study design is a ‚Äúnon-inferiority‚Äù trial. The goal here is to show that some intervention is <em>not inferior</em>, that is not worse, than some already approved intervention, by some specific definition of <em>not worse</em>. While this may sound straightforward, it can be tricky! Especially because in all clinical trials we are working with a <em>sample</em> of individuals, so there is necessarily uncertainty around the estimates we can calculate. Also, the definition of <em>not worse</em> can vary.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>The standard error is just the {standard devation} divided by the square-root of the sample size, <span class="math inline">\(n\)</span>, <span class="math inline">\(\frac{sd}{\sqrt{n}}\)</span></p>
</div></div><p>In statistics speak, this <em>uncertainty</em> is often quantified as a <em>standard error</em>, a measure that takes into account both the standard deviation of our outcome of interest and the number of people we have measured this outcome on. What do I mean? Here is an example.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p><strong>GMT:</strong> geometric mean titer. This is a measure of the antibody titers. We use the <em>geometric</em> mean because this data is quite skewed (it is also why you typically see it plotted on the log scale). For those of you who ‚ù§Ô∏è math, the equation for the geometric mean is just <span class="math inline">\(\exp\{\frac{\sum_{i=1}^n\textrm{log}(x_i)}{n}\}\)</span></p>
</div></div><p>Let‚Äôs say we want to know whether <code>new intervention</code> is not inferior to <code>benchmark intervention</code> with respect to some measure, in this case we are going to use the geometric mean titers (GMT), a common measure of antibody response. In this first example, the <em>truth</em> is these two interventions yield the same <code>GMT</code>, that is, they are equivalent, so <code>new intervention</code> is not inferior to <code>benchmark intervention</code>. Let‚Äôs say we have a sample of 253 people who received the benchmark intervention. The <em>truth</em> is that <code>GMT</code> is 1142.5 with a standard deviation of 0.8. We won‚Äôt see these <em>exact</em> results in our benchmark intervention group since we‚Äôre just looking at one sample of 253. The plot below shows what our 253 folks could look like if we were to collect these data 10 different times. The circles represent the <code>GMT</code> in each sample and the lines show the 95% confidence intervals.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Note: If we were trying to conduct a hypothesis test to establish whether the mean was different from 1142, and we collected these same 10 samples, the 4th sample would result in a <em>Type 1 error</em>, that is we‚Äôd reject the null hypothesis that the mean is equal to 1142 even though that is the <em>truth</em>. When using 95% confidence intervals, we expect to see a <em>Type 1 error</em> 5% of the time.</p>
</div></div><p>In reality, we would only see <em>one</em> of these results. Notice how some of these estimates differ from what we know is the <em>truth</em> (a GMT of 1142), for example the 4th sample had a geometric mean of 980 ‚Äì this is expected. In fact, based on what we know about confidence intervals, if we repeat this process 100 times, we‚Äôd expect about 5 of these intervals to not contain 1142 <em>at all</em>. Notice the width of the confidence intervals is generally the same. This is determined by the standard deviation (which here is 0.8) and the sample size (253).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ok, so let‚Äôs say we observed the 10th sample in the plot above (<code>GMT</code>: 1146.5 (95% CI: 1257.2, 1045.5)). We want to show that some <code>new intervention</code> yields a <code>GMT</code> that is not inferior (not worse) than this benchmark intervention. One way we could do that is collect data on the new intervention, compare it to the old, and set some <em>criteria</em> for ‚Äúsuccess‚Äù. What would make this <code>new intervention</code> not inferior? Let‚Äôs see what happens if we set our criteria for success to be that the geometric mean titers among our sample of those in the <code>new intervention</code> group is not less than the geometric mean we observed in our <code>benchmark intervention</code> sample. Another way to look at this is to look at the <em>ratio</em> between our two geometric means, the GMT in the <code>new intervention</code> divided by the GMT in the <code>old intervention</code> group. If this ratio is equal to one, they are the same, if the ratio is less than 1, the <code>new intervention</code> is deemed ‚Äúworse‚Äù (inferior) and if the ratio is greater than 1, the <code>new intervention</code> is better. Another way to state this criteria is that the GMT ratio needs to be <span class="math inline">\(\ge 1\)</span>.</p>
<section id="scenario-1-by-non-inferiority-we-mean-the-observed-point-estimates-will-be-equal-or-the-point-estimate-for-the-new-group-will-be-higher" class="level3">
<h3 class="anchored" data-anchor-id="scenario-1-by-non-inferiority-we-mean-the-observed-point-estimates-will-be-equal-or-the-point-estimate-for-the-new-group-will-be-higher">Scenario 1: By ‚Äúnon-inferiority‚Äù we mean the observed point estimates will be equal <em>or</em> the point estimate for the new group will be higher</h3>
</section>
<section id="threshold-gmt-ratio-ge-1" class="level3">
<h3 class="anchored" data-anchor-id="threshold-gmt-ratio-ge-1">Threshold: GMT ratio <span class="math inline">\(\ge 1\)</span></h3>
<p>I am going to generate some <code>new intervention</code> samples, remember we only observe one of these in reality. I am generating them from the <em>same distribution</em> as the <code>old intervention</code>, so the <em>truth</em> here is that the two are equal (and thus also non-inferior). Remember that to generate these samples we also need to know the <em>sample size</em>. Let‚Äôs assume the sample size is the same (253).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot above shows 10 random samples from our <code>new intervention</code>. Remember that these were generated exactly like our <code>old intervention</code>, so the <em>truth</em> is that they are equivalent (and thus it is also true that the <code>new intervention</code> is not inferior, not worse, than the old). Notice here, 50% of the samples ‚Äúfailed‚Äù (in orange in the plot above) by our criteria that the geometric mean (the point estimate) of our <code>new intervention</code> had to be greater than or equal to our observed geometric mean in the <code>old intervention</code>. This is exactly what we‚Äôd expect to happen! Because there is some random chance involved (we are only looking at a sample), the probability of falling on either side of a point estimate is going to be a coin toss when the ‚Äútruth‚Äù is centered there.</p>
<p>Often, the criteria for non-inferiority trials is set based on a <em>lower bound</em> threshold instead. For example, we could say we want to have some certainty that the <code>new intervention</code> is not some percent <em>worse</em> than the old. Maybe we set our lower bound to 0.67. This would mean that in order to be deemed a ‚Äúsuccess‚Äù the lower bound of our geometric mean ratio between the old and new interventions would need to exceed 0.67. Looking at the plot above, this seems easy! However, if we assume the same standard deviation (0.8) and same sample size (253), we can achieve this threshold even if the new intervention is statistically significantly worse. Let‚Äôs see that.</p>
</section>
<section id="scenario-2-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old" class="level3">
<h3 class="anchored" data-anchor-id="scenario-2-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old">Scenario 2: By ‚Äúnon-inferiority‚Äù we mean we can have some level of confidence that the new intervention is not more than 67% worse than the old</h3>
</section>
<section id="threshold-gmt-ratio-lower-bound-ge-0.67" class="level3">
<h3 class="anchored" data-anchor-id="threshold-gmt-ratio-lower-bound-ge-0.67">Threshold: GMT ratio <em>lower bound</em> <span class="math inline">\(\ge 0.67\)</span></h3>
<p>Now I am going to assume that the <em>truth</em> is that the <code>new intervention</code> is only 75% as good as the old, meaning the <em>true</em> ratio between the two is 0.75. This would equate to being around 6 standard errors <em>worse</em> than equal, so pretty bad. Let‚Äôs generate some samples under this assumption and see how we do.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Our lower bound threshold of 0.67 ‚Äúcaught‚Äù our inferior samples ~70% of the time here (in orange), but notice there were three samples that would be considered ‚Äúsuccessful‚Äù by this metric (blue), even though the full confidence interval falls below 1. How likely something like this is to occur depends on two things:</p>
<ol type="1">
<li>the standard deviation of the outcome in <code>new intervention</code> group</li>
<li>the sample size of the <code>new intervention</code> group</li>
</ol>
<p>Often clinical trials need to <em>prespecify</em> their sample size, so we can guard against one of these, but the standard deviation is often just a guess. For example, what if the standard deviation in the <code>new intervention</code> group was much smaller, say half of the standard deviation in the <code>old intervention</code> group. Let‚Äôs see what that looks like.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice in the plot above with the smaller standard deviations, the confidence intervals shrunk! Now we have 60% successes, all with upper bounds less than 1 üò±. This is why often a second criteria is set to guard against this possibility. In the past, I have often seen this as a criteria for the upper bound ‚Äì for example, you could require that the upper bound not be less than 1 to exclude the possibility of a ‚Äúsuccess‚Äù when the new intervention is in fact statistically significantly worse. Why not <em>only</em> set an upper bound criterion? If we did that, we could have the opposite scenario where the <em>true</em> standard deviation is much larger than expected, so despite the upper bound being above one, the confidence interval spans a very large range (like below!).</p>
</section>
<section id="scenario-3-by-non-inferiority-we-mean-the-new-intervention-is-not-statistically-significantly-worse-than-the-old-intervention" class="level3">
<h3 class="anchored" data-anchor-id="scenario-3-by-non-inferiority-we-mean-the-new-intervention-is-not-statistically-significantly-worse-than-the-old-intervention">Scenario 3: By ‚Äúnon-inferiority‚Äù we mean the new intervention is not statistically significantly worse than the old intervention</h3>
</section>
<section id="threshold-gmt-ratio-upper-bound-ge-1" class="level3">
<h3 class="anchored" data-anchor-id="threshold-gmt-ratio-upper-bound-ge-1">Threshold: GMT ratio <em>upper bound</em> <span class="math inline">\(\ge 1\)</span></h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Including both criteria would guard against this. Let‚Äôs look at that across all of the scenarios we‚Äôve explored so far.</p>
</section>
<section id="scenario-4-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-is-not-statistically-significantly-worse-than-the-old-intervention" class="level3">
<h3 class="anchored" data-anchor-id="scenario-4-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-is-not-statistically-significantly-worse-than-the-old-intervention">Scenario 4: By ‚Äúnon-inferiority‚Äù we mean we can have some level of confidence that the new intervention is not more than 67% worse than the old and the new intervention is not statistically significantly worse than the old intervention</h3>
</section>
<section id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-upper-bound-ge-1" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-upper-bound-ge-1">Thresholds: GMT ratio <em>lower bound</em> <span class="math inline">\(\ge 0.67\)</span> AND GMT ratio <em>upper bound</em> <span class="math inline">\(\ge 1\)</span></h3>

<div class="no-row-height column-margin column-container"><div class="">
<p>Remember, I‚Äôm showing you 10 different possible sampling scenarios generated under the same ‚Äútruth‚Äù. In reality, we‚Äôd only observe one of these. The reason I‚Äôm showing 10 is so you can see the <em>probability</em> of success or failure based on the criteria and the truth.</p>
</div></div><div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Beautiful! Now we are failing when we should be, regardless of our standard deviation, and succeeding when we should be (when the truth is that the two groups are the same). What we‚Äôve seen so far is similar to how the immunobridging Pfizer trial was designed to evaluate vaccines in kids. Because Pfizer didn‚Äôt think they would have enough time or participants to accurately estimate the <em>efficacy</em> of the vaccine in young children, they instead designed a trial to compare their antibody response to the antibody response seen in 16-25 year olds, for whom they <em>were</em> able to demonstrate efficacy. The thinking being: if the antibody levels in kids is comprable to that in 16-25 year olds, then hopefully the efficacy will be comparable too. The issue, of course, is what do they mean by <em>comparable</em> (or <em>not inferior</em>). Originally they designed this with two thresholds: the <em>lower bound</em> needed to be <span class="math inline">\(\ge 0.67\)</span> and the <em>point estimate</em> needed to be <span class="math inline">\(\ge 0.8\)</span>. This is similar to scenario 4, but there are important differences, which brings me to scenario 5!</p>
</section>
<section id="scenario-5-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-and-even-more-confidence-that-it-is-not-more-than-80-worse-than-the-old-intervention" class="level3">
<h3 class="anchored" data-anchor-id="scenario-5-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-and-even-more-confidence-that-it-is-not-more-than-80-worse-than-the-old-intervention">Scenario 5: By ‚Äúnon-inferiority‚Äù we mean we can have some level of confidence that the new intervention is not more than 67% worse than the old and the new intervention and even more confidence that it is not more than 80% worse than the old intervention</h3>
</section>
<section id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-point-estimate-ge-0.8" class="level3">
<h3 class="anchored" data-anchor-id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-point-estimate-ge-0.8">Thresholds: GMT ratio <em>lower bound</em> <span class="math inline">\(\ge 0.67\)</span> AND GMT ratio <em>point estimate</em> <span class="math inline">\(\ge 0.8\)</span></h3>
<p>Fixing a non-inferiority bound at a point estimate introduces some complications. By not taking the upper bound into account, we don‚Äôt fully guard against seeing a statistically significantly <em>worse</em> result that ‚Äúsucceeds‚Äù by our criteria. For example, consider the scenario where the ‚Äútruth‚Äù is that the <code>new intervention</code> is 85% as good as the old. This passes our definition of ‚Äúnon-inferiority‚Äù, but we could end up with many cases where the new intervention is statistically significantly worse but still ‚Äúsuccessful‚Äù. Much of these decisions need to be grounded both in the statistics <em>and</em> the science. If it is deemed scientifically acceptable that generating 85% of an antibody response is ok, then this is a fine threshold.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This will succeed 90% of the time, but notice that but notice that 8 of the 9 ‚Äúsuccesses‚Äù the confidence interval indicates that the intervention is statistically significantly worse.</p>
<p>It turns out, after Pfizer finished their 5-11 trial, <a href="https://www.nejm.org/doi/full/10.1056/NEJMoa2116298">the FDA requested that they move this second threshold to be more stringent.</a>. Instead of needing a <em>point estimate</em> <span class="math inline">\(\ge 0.8\)</span>, they now needed a <em>point estimate</em> <span class="math inline">\(\ge 1\)</span>.</p>
<p>This is where things get tricky! Recall from the very first scenario that we looked at that setting a threshold based on the point estimate like this will <strong>fail 50% of the time</strong> even if the truth is that the two groups are exactly equal. By imposing this new threshold, the FDA is essentially requiring that the antibody response in children by <strong>superior</strong> to that in 16-25 year olds, not just <em>not inferior</em>. In addition, setting this threshold like this essentially renders the lower bound moot unless the variability in antibody response is much larger in young children compared to 16-25 year olds. In fact, in order for that ‚Äúlower bound <span class="math inline">\(\ge 0.67\)</span>‚Äù threshold to be invoked while the ‚Äúpoint estimate <span class="math inline">\(\ge 1\)</span>‚Äù succeeds, the actual standard deviation in the young children‚Äôs antibody titers would need to be about 4 times that observed in the older cohort. This threshold (the need to have the point estimate <span class="math inline">\(\ge 1\)</span>) basically sets a large ‚Äúweight‚Äù on the younger antibody response needing to be much <strong>stronger</strong> than that observed in the older cohort. Let‚Äôs take the 2-4 year olds as an example.</p>
</section>
<section id="scenario-6-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-and-even-more-confidence-that-it-is-not-any-worse-than-the-old-intervention" class="level3">
<h3 class="anchored" data-anchor-id="scenario-6-by-non-inferiority-we-mean-we-can-have-some-level-of-confidence-that-the-new-intervention-is-not-more-than-67-worse-than-the-old-and-the-new-intervention-and-even-more-confidence-that-it-is-not-any-worse-than-the-old-intervention">Scenario 6: By ‚Äúnon-inferiority‚Äù we mean we can have some level of confidence that the new intervention is not more than 67% worse than the old and the new intervention and even more confidence that it is not <em>any</em> worse than the old intervention</h3>
</section>
<section id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-point-estimate-ge-1" class="level3">
<h3 class="anchored" data-anchor-id="thresholds-gmt-ratio-lower-bound-ge-0.67-and-gmt-ratio-point-estimate-ge-1">Thresholds: GMT ratio <em>lower bound</em> <span class="math inline">\(\ge 0.67\)</span> AND GMT ratio <em>point estimate</em> <span class="math inline">\(\ge 1\)</span></h3>
<p>If we think that an antibody response <em>exactly equal</em> to that seen by 16-25 year olds is sufficient to deem this vaccine <em>non inferior</em>, then this is not the right threshold, as a trial testing this way will <strong>fail 50% of the time</strong>. That is, the chance of failing is a coin toss, even if the two groups are exactly equal. Below shows this again. Remember for a given trial, we are only lucky enough to see <em>one</em> of these outcomes in the plot below; I am showing 10 so you can see the variation based on the sampling variability.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Statistically, in order to have a 85% chance of ‚Äúsuccess‚Äù, the truth would need to be that the antibody response in kids is ~1 standard error higher compared to 16-25 year olds. This is based on basic normal theory. It turns out if a variable is log normally distributed, the geometric mean is equivalent to the median of the distribution, which ties to the mean of the <em>normal</em> distribution. Therefore, we can use basic normal theory to understand the impact of requiring the <em>point estimate</em> of a distribution to be greater than some value. Assuming that the <em>truth</em> is that this point estimate (the GMT ratio) is 1 <span class="math inline">\(\times\)</span> x [standard errors], and you take a sample from a log normally distributed population, the probability that the GMT ratio that you <em>observe</em> is 1 is equal to <code>qnorm(x)</code>. For example, if the <em>truth</em> is that the GMT ratio is 1 <span class="math inline">\(\times 1.96\)</span> [standard errors], and you ran this trial a bunch of times, you would expect a ‚Äúsuccess‚Äù 95% of the time. (The 5% of the time that you saw a ‚Äúfailure‚Äù would be considered a Type II error).</p>
<p>SO what does this mean? Well it depends on what the standard deviation ends up being for 2-4 year old antibody response. If it is the same as 16-25 year olds, in order to avoiding making a Type II error more than 15% of the time, the geometric mean of the antibody response in 2-4 year olds would need to be 5-6% higher than what was observed in 16-25 year olds. If their standard deviation is actually <em>larger</em> this will increase, for example if it was 2, the <em>true</em> antibody response in 2-4 year olds would need to be ~ 14% higher.</p>
<p>As many have pointed out, it is not uncommon for pediatric trials to be held to a higher standard, often requiring efficacy beyond what is required of adults due to an appropriate caution against intervention in an often vulnerable group. I fully believe that the regulators that requested this had every best intention in doing so. In this particular case, however, this type of threshold can potentially lead to the <em>opposite</em> effect. By requiring the younger children to mount a <em>higher</em> antibody response than the older cohort in order to pass regulatory hurdles, we may be inadvertently pushing towards higher dosing, for example.</p>
<p>Is this why the 2-4 year old vaccine failed previously? It‚Äôs not totally clear since the data hasn‚Äôt been released, however based on the tid bits we‚Äôve gotten from media reports, I don‚Äôt think so. <a href="https://www.nytimes.com/2022/02/11/us/politics/fda-children-pfizer-vaccine.html">The New York Times reported</a>, for example, that the 2-4 vaccine only elicited 60% of the response compared to the 16-25 year olds, suggesting that it would have failed by the lower bound criteria alone. So why does this matter? Presumably, these thresholds will be used to compare the post-3rd dose response to the 16-25 year olds as well ‚Äì does it make sense to require the under 5s to have a <strong>stronger</strong> antibody response than the 16-25 year olds? Especially with no other option for protection via a vaccine for this age group, I would say no.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "Óßã";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.livefreeordichotomize\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<script src="https://utteranc.es/client.js" repo="lfod/lfod.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>